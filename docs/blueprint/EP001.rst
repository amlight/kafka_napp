:EP: 1
:Title: Kafka NApp Proposal
:Authors:
    - Austin Uwate <auwate AT fiu DOT edu>
:Created: 2025-02-12
:Status: Draft
:Type: Standard

****************************************
EP001 - Kafka NApp Proposal
****************************************


Abstract
========

This blueprint, EP 001, seeks to outline the requirements, features, and it's implementation to support innovative projects built by the Kytos team.


Motivation
==========

- ...

Rationale
=========

The implementation took a simple, object-oriented approach in development. The main reasons behind this were:

  1. Encapsulation of Concerns - Each component (e.g., Kafka operations and async scheduling) is self-contained with a clear boundary, reducing unintended side effects and making debugging easier.
  2. Code Reusability & Maintainability - By encapsulating logic within classes and methods, components can be reused when the project is extended or updated without modifying core functionality.
  3. Improved Readability & Organization - Object-oriented code structures the application into well-defined classes, making it easier to navigate, understand, and modify.
  4. Testability - With an object-oriented approach, dependencies (such as Kafka clients or async handlers) can be injected, making unit testing and mocking easier.

I. Requirements
===============

This blueprint has the following characteristics:

  1. -
  2. -
  ...

II. How kafka_napp works with Kytos
===============================

...


III. How kafka_napp interacts with Kafka
===============================================

...


IV. Configurations in settings.py
==============================

...


V. Events
==========

  1. Listening
    1. ...

The following table specifies expected actions when handling certain events. In the end, each are serialized and sent to Kafka:

+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| kytos/mef_eline.<name> event     | mef_eline EVC action                                               | telemetry_int EVC action                              |
+==================================+====================================================================+=======================================================+
| ``undeployed``                   | remove flows                                                       | remove flows; deactivate                              |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``deployed``                     | redeploy                                                           | if requested INT, enable if first time or redeploy    |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``deleted``                      | remove flows; delete; archive                                      | remove flows; disable                                 |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``redeployed_link_down``         | redeploy                                                           | same                                                  |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``redeployed_link_up``           | redeploy                                                           | same                                                  |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``error_redeploy_link_down``     | remove flows; deactivate                                           | same                                                  |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``failover_link_down``           | install ingress flows; publish new flows                           | generate subset flows; install flows                  |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``failover_old_path``            | remove old flows; publish old flows (old current_path or failover) | generate subset flows; remove flows                   |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``failover_deployed``            | remove failover; install failover flows; publish old and new flows | generate subset flows; remove old; install new        |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+
| ``uni_active_updated``           | deactivate or activate                                             | same                                                  |
+----------------------------------+--------------------------------------------------------------------+-------------------------------------------------------+


VI. REST API
=============

  - ``GET /api/kytos/kafka/v1/`` ...
  - ``POST /api/kytos/kafka/v1/`` ...


VII. Dependencies
=================

 * kytos


VII. Kafka message structure
======================

...


XIII. Implementation details ``v1``
===================================

# Clarify how the implementation works in steps, starting from start up.

The following requirements clarify certain details and expected behavior for ``telemetry_int`` v1 that will be shipped with Kytos-ng ``2023.2``:

- ...

- ...

XIV. Open Questions / Future Work
=================================

  1. Error codes
  2. Specifying what events are not needed, thus not processing them